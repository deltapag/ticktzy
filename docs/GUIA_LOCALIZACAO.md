# Guia de Localiza√ß√£o - Projeto Ticktzy

Este documento serve como um mapa completo para localizar cada parte da aplica√ß√£o: telas, l√≥gicas de neg√≥cio, fun√ß√µes e arquivos relacionados.

---

## üìÇ Estrutura de Pastas - Vis√£o Geral

```
app/src/main/java/br/com/sttsoft/ticktzy/
‚îú‚îÄ‚îÄ core/                    # Componentes base reutiliz√°veis
‚îú‚îÄ‚îÄ domain/                  # L√≥gica de neg√≥cio (Use Cases)
‚îú‚îÄ‚îÄ features/                 # Features com MVVM
‚îú‚îÄ‚îÄ presentation/             # Interface do usu√°rio
‚îú‚îÄ‚îÄ repository/               # Camada de dados
‚îî‚îÄ‚îÄ extensions/               # Extens√µes Kotlin
```

---

## üèóÔ∏è 1. CORE - Componentes Base

### üìç `core/device/`

**Fun√ß√£o**: Controle de dispositivos f√≠sicos (impressoras)

| Arquivo | O que faz |
|---------|-----------|
| `PrinterController.kt` | Interface para controle de impressora |
| `PrinterControllerSunmi.kt` | Implementa√ß√£o espec√≠fica para impressoras Sunmi |
| `PosmpReceiptController.kt` | Interface para impress√£o POSMP |
| `PosmpReceiptControllerImpl.kt` | Implementa√ß√£o para impress√£o POSMP |

**Como usar**: Acesso via `printerController` em Activities que herdam de `BaseActivity`

---

### üìç `core/prefs/`

**Fun√ß√£o**: Gerenciamento de prefer√™ncias (SharedPreferences)

| Arquivo | O que faz |
|---------|-----------|
| `PrefsGateway.kt` | Interface para acesso a prefer√™ncias |
| `PrefsGatewayImpl.kt` | Implementa√ß√£o concreta (SharedPreferences) |

**Chaves importantes armazenadas**:
- `CAIXA`: Valor atual do caixa
- `CAIXA_INICIAL`: Valor inicial do caixa
- `CAIXA_ABERTO`: Status do caixa
- `SALES_MADE`: Total de vendas
- `{TYPE}_TYPE`: Contadores por tipo de pagamento
- `{TYPE}_VALUE`: Valores por tipo de pagamento

---

### üìç `core/result/`

**Fun√ß√£o**: Tratamento de resultados de opera√ß√µes

| Arquivo | O que faz |
|---------|-----------|
| `AppResult.kt` | Sealed class para sucesso/erro |
| `ErrorModel.kt` | Modelo de erro estruturado |
| `ErrorMapper.kt` | Mapeamento de erros |

**Exemplo**:
```kotlin
sealed class AppResult<out T> {
    data class Success<T>(val data: T): AppResult<T>()
    data class Failure(val error: ErrorModel): AppResult<Nothing>()
}
```

---

### üìç `core/ui/`

**Fun√ß√£o**: Componentes de UI base (MVVM)

| Arquivo | O que faz |
|---------|-----------|
| `BaseViewModel.kt` | ViewModel base com StateFlow e Channel |
| `UiState.kt` | Interface para estados da UI |
| `UiEvent.kt` | Interface para eventos da UI |
| `UiEffect.kt` | Interface para efeitos colaterais |
| `defaultVmFactory.kt` | Factory para criar ViewModels |
| `viewbinding/collect.kt` | Extens√µes para coletar flows |

---

## üß† 2. DOMAIN - L√≥gica de Neg√≥cio

### üìç `domain/` (Use Cases)

**Fun√ß√£o**: Encapsular l√≥gica de neg√≥cio isolada

| Arquivo | O que faz | Onde √© usado |
|---------|-----------|--------------|
| `GetDadosSubUseCase.kt` | Busca dados de subaquirente | Splash, Config |
| `GetInfosUseCase.kt` | Busca informa√ß√µes do terminal | SplashActivity |
| `GetProductsUseCase.kt` | Busca produtos do servidor | ProductSyncUseCase |
| `ProductCacheUseCase.kt` | Cache local de produtos | Splash, Sale |
| `ProductSyncUseCase.kt` | Sincroniza produtos (servidor ‚Üî local) | SplashActivity |
| `PrinterUseCase.kt` | L√≥gica de impress√£o | Sale, Cashier |
| `SitefUseCase.kt` | Integra√ß√£o com SiTef (pagamentos) | SaleActivity |
| `TerminalnfosUseCase.kt` | Informa√ß√µes do terminal | SplashActivity |
| `VerifyTlsComunicationUseCase.kt` | Verifica TLS | Config |

---

## üé® 3. FEATURES - Funcionalidades

### üìç `features/sale/`

**Fun√ß√£o**: Feature de vendas com MVVM completo

| Arquivo | O que faz |
|---------|-----------|
| `SaleState.kt` | Define estado da tela de vendas |
| `SaleEvent.kt` | Define eventos (Load, Search, Pay, etc) |
| `SaleEffect.kt` | Define efeitos (Toast, Navega√ß√£o, Print) |
| `SaleViewModel.kt` | Gerencia l√≥gica de vendas |
| `ui/SalesActivity.kt` | Activity de vendas |

**Eventos principais**:
- `Load`: Carrega produtos
- `Search`: Busca produtos
- `CashPay`: Pagamento em dinheiro
- `PixPay`: Pagamento PIX
- `CardPay`: Pagamento com cart√£o

---

## üì± 4. PRESENTATION - Interface do Usu√°rio

### üìç `presentation/base/`

**Fun√ß√£o**: Activities base com funcionalidades compartilhadas

| Arquivo | O que faz |
|---------|-----------|
| `BaseActivity.kt` | Activity base com binding de impressoras, di√°logos, etc |
| `SplashActivity.kt` | Tela inicial que sincroniza dados |

**Funcionalidades de BaseActivity**:
- Binding de impressoras Sunmi e POSMP
- Dialog de loading
- Toast
- Controle de navega√ß√£o

---

### üìç `presentation/home/`

**Fun√ß√£o**: Tela principal

| Arquivo | O que faz |
|---------|-----------|
| `HomeActivity.kt` | Menu principal com navega√ß√£o |
| **Layout**: `activity_home.xml` | Layout com bot√µes de a√ß√£o |

**Bot√µes**:
- Nova Venda ‚Üí `SaleActivity`
- Cobran√ßa ‚Üí `ChargeActivity`
- Relat√≥rios (n√£o implementado)
- Config ‚Üí `ConfigActivity`
- Fun√ß√µes do Caixa ‚Üí `ActivityCashierHome`
- Fun√ß√µes Administrativas ‚Üí `ActivitySitefHome`

**Layout**: `app/src/main/res/layout/activity_home.xml`

---

### üìç `presentation/sale/`

**Fun√ß√£o**: M√≥dulo de vendas

| Arquivo | O que faz |
|---------|-----------|
| `ui/SaleActivity.kt` | Tela principal de vendas |
| `components/PaymentBar.kt` | Barra de pagamentos (PIX, Cart√£o) |
| `components/ProductAdapter.kt` | Adapter para lista de produtos |
| `components/ProductViewHolder.kt` | ViewHolder de produto |
| `components/SearchBar.kt` | Barra de busca |

**Layouts**:
- `activity_sale.xml`: Layout principal
- `component_payment_bar.xml`: Barra de pagamento
- `component_product_item.xml`: Item de produto
- `component_search_bar.xml`: Barra de busca

**Fluxo de Venda**:
```
SaleActivity ‚Üí Adicionar Produtos ‚Üí Escolher Pagamento ‚Üí Processar ‚Üí Imprimir ‚Üí Finalizar
```

---

### üìç `presentation/cashier/start/`

**Fun√ß√£o**: Abertura de caixa

| Arquivo | O que faz |
|---------|-----------|
| `ActivityCashierStart.kt` | Interface para abertura de caixa |
| `ActivityCashierBase.kt` | L√≥gica compartilhada (base para Start/Finish) |

**Layout**: `app/src/main/res/layout/activity_cashier_start.xml`

**Fluxo**:
```
ActivityCashierStart ‚Üí Verifica se caixa j√° est√° aberto ‚Üí Pede valor inicial ‚Üí Imprime comprovante ‚Üí Navega para Home
```

---

### üìç `presentation/cashier/home/`

**Fun√ß√£o**: Home do caixa (menu de opera√ß√µes)

| Arquivo | O que faz |
|---------|-----------|
| `ActivityCashierHome.kt` | Menu com op√ß√µes de caixa |

**Op√ß√µes**:
- Refor√ßo de caixa
- Sangria
- Fechamento

**Layout**: `app/src/main/res/layout/activity_cashier_home.xml`

---

### üìç `presentation/cashier/finish/`

**Fun√ß√£o**: Fechamento de caixa

| Arquivo | O que faz |
|---------|-----------|
| `ActivityCashierFinish.kt` | Mostra relat√≥rio e fecha caixa |
| `components/tableInfos.kt` | Data class para itens da tabela |
| `components/TableInfosAdapter.kt` | Adapter para exibir informa√ß√µes |

**Layout**: `app/src/main/res/layout/activity_cashier_finish.xml`

**Componentes**:
- `component_table_info_row.xml`: Linha da tabela
- `component_table_info_section.xml`: Se√ß√£o da tabela

**Informa√ß√µes exibidas**:
- Total de vendas
- Total de cobran√ßas
- Sangrias e refor√ßos realizados
- Resumo por tipo de pagamento
- Valores finais

---

### üìç `presentation/cashier/reinforce/`

**Fun√ß√£o**: Refor√ßo de caixa

| Arquivo | O que faz |
|---------|-----------|
| `CashierReinforceActivity.kt` | Interface para refor√ßo de caixa |

**Layout**: Em `app/src/main/res/layout/`

---

### üìç `presentation/cashier/sangria/`

**Fun√ß√£o**: Sangria de caixa

| Arquivo | O que faz |
|---------|-----------|
| `CashierSangriaActivity.kt` | Interface para sangria de caixa |

**Layout**: Em `app/src/main/res/layout/`

---

### üìç `presentation/config/`

**Fun√ß√£o**: Configura√ß√µes do sistema

| Arquivo | O que faz |
|---------|-----------|
| `ConfigActivity.kt` | Configura√ß√µes gerais |
| `ConfigSitefInfosActivity.kt` | Configura√ß√£o SiTef |
| `ConfigTicketActivity.kt` | Configura√ß√£o de impress√£o |

**Layouts**: `activity_config.xml`, etc.

---

### üìç `presentation/dialogs/`

**Fun√ß√£o**: Di√°logos reutiliz√°veis

| Arquivo | O que faz | Quando usar |
|---------|-----------|-------------|
| `ChangeDialog.kt` | Di√°logo de troco | Vendas em dinheiro |
| `ConfirmDialog.kt` | Di√°logo de confirma√ß√£o | Confirma√ß√µes gerais |
| `InputDialog.kt` | Di√°logo de input | Entrada de dados |
| `LoadingDialogFragment.kt` | Loading | Opera√ß√µes ass√≠ncronas |
| `PaymentTypeChooseDialog.kt` | Escolha de pagamento | Escolha entre d√©bito/cr√©dito |

**Layouts**: Em `app/src/main/res/layout/dialog_*.xml`

---

### üìç `presentation/charge/`

**Fun√ß√£o**: Cobran√ßa

| Arquivo | O que faz |
|---------|-----------|
| `ChargeActivity.kt` | Interface de cobran√ßa |

**Layout**: `activity_charge.xml`

---

### üìç `presentation/sitef/`

**Fun√ß√£o**: Home administrativo SiTef

| Arquivo | O que faz |
|---------|-----------|
| `ActivitySitefHome.kt` | Menu administrativo SiTef |

**Layout**: `activity_sitef_home.xml`

---

## üíæ 5. REPOSITORY - Camada de Dados

### üìç `repository/local/`

**Fun√ß√£o**: Cache e armazenamento local

| Arquivo | O que faz |
|---------|-----------|
| `product.kt` | Modelo de produto para cache |

**Armazenamento**: SharedPreferences

---

### üìç `repository/remote/`

**Fun√ß√£o**: Comunica√ß√£o com APIs

#### **Interfaces Retrofit** (`repositorys/`)

| Arquivo | O que faz |
|---------|-----------|
| `InfoRepository.kt` | Busca informa√ß√µes do terminal |
| `ProductsRepository.kt` | Busca produtos do servidor |

#### **Clientes HTTP** (`root/`)

| Arquivo | O que faz |
|---------|-----------|
| `MSCall.kt` | Client Retrofit base |
| `MSCallProducts.kt` | Client para produtos (Back4App) |

#### **Modelos de Requisi√ß√£o** (`request/`)

| Arquivo | O que faz |
|---------|-----------|
| `Terminal.kt` | Dados do terminal |
| `TerminalWrapper.kt` | Wrapper de terminal |

#### **Modelos de Resposta** (`response/`)

| Arquivo | O que faz |
|---------|-----------|
| `ProductsResponse.kt` | Resposta de produtos |
| `InfoResponse.kt` | Informa√ß√µes do terminal |
| `Sitef.kt`, `LojaSitef.kt`, `Pagamento.kt` | Dados relacionados a pagamento |
| `App.kt` | Configura√ß√µes do app |
| `AtualizacaoRemota.kt` | Atualiza√ß√µes remotas |
| `Subadquirencia.kt` | Dados de subaquirente |

---

## üîß 6. EXTENSIONS - Extens√µes Kotlin

### üìç `extensions/`

**Fun√ß√£o**: Facilitar opera√ß√µes comuns

| Arquivo | O que faz | M√©todos principais |
|---------|-----------|---------------------|
| `DoubleExt.kt` | Extens√µes para Double | `toReal()`, `toRealFormatado()` |
| `ImageViewExt.kt` | Extens√µes para ImageView | Carregamento de imagens |
| `LongExt.kt` | Extens√µes para Long | `toReal()`, convers√µes |
| `NetworkExt.kt` | Extens√µes de rede | Verifica√ß√µes de conectividade |
| `SharedPrefsExtensions.kt` | Extens√µes para Prefs | `savePref()`, `getPref()`, `saveToPrefs()`, `getFromPrefs()` |
| `StringExt.kt` | Extens√µes para String | Formata√ß√µes |

---

## üóÇÔ∏è Layouts XML

### üìç `app/src/main/res/layout/`

**Principais layouts**:

| Layout | O que √© | Usado por |
|--------|---------|-----------|
| `activity_home.xml` | Tela principal | HomeActivity |
| `activity_sale.xml` | Tela de vendas | SaleActivity |
| `activity_splash.xml` | Splash screen | SplashActivity |
| `activity_cashier_start.xml` | Abertura de caixa | ActivityCashierStart |
| `activity_cashier_finish.xml` | Fechamento de caixa | ActivityCashierFinish |
| `activity_cashier_home.xml` | Home do caixa | ActivityCashierHome |
| `component_payment_bar.xml` | Barra de pagamento | PaymentBar |
| `component_product_item.xml` | Item de produto | ProductAdapter |
| `component_search_bar.xml` | Barra de busca | SearchBar |
| `dialog_*.xml` | Di√°logos | Dialogs |

---

## üéØ Localiza√ß√£o por Funcionalidade

### Como encontrar "Tela de Vendas"?
```
üìÅ presentation/sale/ui/SaleActivity.kt
üìÅ presentation/sale/components/
    - PaymentBar.kt
    - ProductAdapter.kt
    - SearchBar.kt
üìÅ features/sale/
    - SaleState.kt
    - SaleEvent.kt
    - SaleViewModel.kt
```

### Como encontrar "L√≥gica de Impress√£o"?
```
üìÅ domain/PrinterUseCase.kt
üìÅ core/device/
    - PrinterController.kt
    - PrinterControllerSunmi.kt
üìÅ presentation/base/BaseActivity.kt (bindPrinter)
```

### Como encontrar "Integra√ß√£o SiTef"?
```
üìÅ domain/SitefUseCase.kt
üìÅ presentation/sitef/ActivitySitefHome.kt
üìÅ repository/remote/response/ (modelos SiTef)
```

### Como encontrar "Gerenciamento de Caixa"?
```
üìÅ presentation/cashier/
    - start/ActivityCashierStart.kt
    - home/ActivityCashierHome.kt
    - finish/ActivityCashierFinish.kt
    - reinforce/CashierReinforceActivity.kt
    - sangria/CashierSangriaActivity.kt
```

### Como encontrar "Cache de Produtos"?
```
üìÅ domain/ProductCacheUseCase.kt
üìÅ domain/ProductSyncUseCase.kt
üìÅ repository/local/product.kt
üìÅ extensions/SharedPrefsExtensions.kt
```

---

## üîç Busca R√°pida de Arquivos

### Se voc√™ quer...

**Modificar lista de produtos**: `presentation/sale/ui/SaleActivity.kt` + `components/ProductAdapter.kt`

**Adicionar novo tipo de pagamento**: `features/sale/SaleViewModel.kt` + `SaleEvent.kt`

**Implementar impress√£o**: `domain/PrinterUseCase.kt` + `core/device/`

**Integrar nova API**: `repository/remote/MSCall.kt` + `repositorys/*.kt`

**Adicionar nova tela**: `presentation/[feature]/[Activity].kt` + layout em `res/layout/`

**Extens√µes de tipos**: `extensions/*.kt`

**Use Cases**: `domain/*UseCase.kt`

---

## üìä Mapa de Navega√ß√£o

```
SplashActivity (entry point)
    ‚Üì
ActivityCashierStart (se caixa fechado)
    ‚Üì
HomeActivity
    ‚îú‚îÄ‚Üí SaleActivity
    ‚îÇ     ‚îú‚îÄ‚Üí PaymentTypeChooseDialog
    ‚îÇ     ‚îú‚îÄ‚Üí ChangeDialog (dinheiro)
    ‚îÇ     ‚îî‚îÄ‚Üí Finish (imprime tickets)
    ‚îÇ
    ‚îú‚îÄ‚Üí ChargeActivity
    ‚îÇ
    ‚îú‚îÄ‚Üí ConfigActivity
    ‚îÇ     ‚îú‚îÄ‚Üí ConfigSitefInfosActivity
    ‚îÇ     ‚îî‚îÄ‚Üí ConfigTicketActivity
    ‚îÇ
    ‚îî‚îÄ‚Üí ActivityCashierHome (com senha)
          ‚îú‚îÄ‚Üí Refor√ßo
          ‚îú‚îÄ‚Üí Sangria
          ‚îî‚îÄ‚Üí ActivityCashierFinish
```

---

## üé® Recursos Visuais

### üìç `app/src/main/res/`

#### **drawable/**: √çcones e imagens de background
- `ic_*.xml`: √çcones vetoriais
- `bg_*.xml`: Backgrounds de componentes
- `button_*.xml`: Estilos de bot√µes
- `component_*.xml`: Backgrounds de componentes

#### **layout/**: Layouts XML
- `activity_*.xml`: Activities
- `component_*.xml`: Componentes reutiliz√°veis
- `dialog_*.xml`: Di√°logos

#### **values/**: Recursos de valores
- `strings.xml`: Textos
- `colors.xml`: Cores
- `dimens.xml`: Dimens√µes
- `themes.xml`: Temas

---

## üí° Dicas de Navega√ß√£o

1. **Classes base**: Sempre comece por `BaseActivity` e `BaseViewModel`
2. **Use Cases**: Sempre no diret√≥rio `domain/`
3. **State management**: Consulte `core/ui/` para entender o padr√£o
4. **Layouts**: Sempre em `res/layout/` com nome correspondente √† Activity
5. **Dialogs**: Em `presentation/dialogs/`
6. **API**: Em `repository/remote/`

---

Este guia deve cobrir todas as suas necessidades de localiza√ß√£o no projeto! üéØ

